<!-- Navbar moderna e profissional -->
<% var currentPage = (typeof currentPage !== 'undefined') ? currentPage : ''; %>
<nav class="navbar navbar-expand-lg navbar-modern fixed-top">
    <div class="container-fluid">
        <!-- Brand/Logo -->
        <a class="navbar-brand brand-modern" href="/">
            <i class="fas fa-chart-line brand-icon"></i>
            <span class="brand-text">FinanSave</span>
        </a>

        <!-- Mobile toggle button -->
        <button class="navbar-toggler navbar-toggler-modern" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon-modern">
                <span></span>
                <span></span>
                <span></span>
            </span>
        </button>

        <!-- Navigation items -->
        <div class="collapse navbar-collapse" id="navbarNav">
            <% if (user) { %>
                <!-- Main navigation -->
                <ul class="navbar-nav navbar-nav-modern me-auto">
                    <li class="nav-item">
                        <a class="nav-link nav-link-modern <%= currentPage === 'dashboard' ? 'active' : '' %>" href="/">
                            <i class="fas fa-tachometer-alt nav-icon"></i>
                            <span class="nav-text">Dashboard</span>
                        </a>
                    </li>
                    
                    <li class="nav-item">
                        <a class="nav-link nav-link-modern <%= currentPage === 'contas' ? 'active' : '' %>" href="/contas">
                            <i class="fas fa-wallet nav-icon"></i>
                            <span class="nav-text">Contas</span>
                        </a>
                    </li>
                    
                    <li class="nav-item">
                        <a class="nav-link nav-link-modern <%= currentPage === 'metas' ? 'active' : '' %>" href="/metas">
                            <i class="fas fa-bullseye nav-icon"></i>
                            <span class="nav-text">Metas</span>
                        </a>
                    </li>
                    
                    <li class="nav-item">
                        <a class="nav-link nav-link-modern <%= currentPage === 'orcamentos' ? 'active' : '' %>" href="/orcamentos">
                            <i class="fas fa-calculator nav-icon"></i>
                            <span class="nav-text">Orçamentos</span>
                        </a>
                    </li>
                    
                    <li class="nav-item">
                        <a class="nav-link nav-link-modern <%= currentPage === 'transferencias' ? 'active' : '' %>" href="/transferencias">
                            <i class="fas fa-exchange-alt nav-icon"></i>
                            <span class="nav-text">Transferências</span>
                        </a>
                    </li>
                    
                    <!-- Dropdown para Gastos -->
                    <li class="nav-item dropdown dropdown-modern">
                        <a class="nav-link nav-link-modern dropdown-toggle <%= currentPage === 'gastos' ? 'active' : '' %>" href="#" id="gastosDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="fas fa-credit-card nav-icon"></i>
                            <span class="nav-text">Gastos</span>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-modern" aria-labelledby="gastosDropdown">
                            <li>
                                <a class="dropdown-item dropdown-item-modern" href="/gastos/criar">
                                    <i class="fas fa-plus dropdown-icon"></i>
                                    <span class="dropdown-text">Registrar Gasto</span>
                                </a>
                            </li>
                            <li>
                                <a class="dropdown-item dropdown-item-modern" href="/gastos/extrato">
                                    <i class="fas fa-list dropdown-icon"></i>
                                    <span class="dropdown-text">Ver Gastos</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                    
                    <li class="nav-item">
                        <a class="nav-link nav-link-modern <%= currentPage === 'parcelamentos' ? 'active' : '' %>" href="/parcelamentos">
                            <i class="fas fa-calendar-alt nav-icon"></i>
                            <span class="nav-text">Parcelamentos</span>
                        </a>
                    </li>
                </ul>

                <!-- User profile dropdown -->
                <ul class="navbar-nav navbar-nav-modern">
                    <li class="nav-item dropdown dropdown-modern user-dropdown">
                        <a class="nav-link nav-link-modern dropdown-toggle user-profile-link" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <div class="nav-avatar" aria-hidden="true">
                                <span><%= (user.nome || 'U')[0] %></span>
                            </div>
                            <div class="user-info">
                                <span class="user-name"><%= user.nome %></span>
                                <span class="user-email"><%= user.email %></span>
                            </div>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-modern dropdown-menu-end user-dropdown-menu" aria-labelledby="userDropdown">
                            <li class="dropdown-header">
                                <div class="user-profile-header">
                                    <div class="user-avatar-large nav-avatar" style="width:56px;height:56px; font-size:1rem;">
                                        <span><%= (user.nome || 'U')[0] %></span>
                                    </div>
                                    <div class="user-details">
                                        <strong><%= user.nome %></strong>
                                        <small class="text-muted"><%= user.email %></small>
                                    </div>
                                </div>
                            </li>
                            <li><hr class="dropdown-divider"></li>
                            <li>
                                <a class="dropdown-item dropdown-item-modern" href="/perfil">
                                    <i class="fas fa-user-cog dropdown-icon"></i>
                                    <span class="dropdown-text">Meu Perfil</span>
                                </a>
                            </li>
                            <li>
                                <a class="dropdown-item dropdown-item-modern" href="/configuracoes">
                                    <i class="fas fa-cog dropdown-icon"></i>
                                    <span class="dropdown-text">Configurações</span>
                                </a>
                            </li>
                            <li><hr class="dropdown-divider"></li>
                            <li>
                                <a class="dropdown-item dropdown-item-modern text-danger" href="/logout">
                                    <i class="fas fa-sign-out-alt dropdown-icon"></i>
                                    <span class="dropdown-text">Sair</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                </ul>
            <% } else { %>
                <!-- Guest navigation -->
                <ul class="navbar-nav navbar-nav-modern ms-auto">
                    <li class="nav-item">
                        <a class="nav-link nav-link-modern" href="/usuarios/login">
                            <i class="fas fa-sign-in-alt nav-icon"></i>
                            <span class="nav-text">Entrar</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link nav-link-modern btn-outline-primary-modern" href="/usuarios/registro">
                            <i class="fas fa-user-plus nav-icon"></i>
                            <span class="nav-text">Cadastrar</span>
                        </a>
                    </li>
                </ul>
            <% } %>
        </div>
    </div>
</nav>

<!-- Spacer para compensar navbar fixa -->
<div class="navbar-spacer"></div>