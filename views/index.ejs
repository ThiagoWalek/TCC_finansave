<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <%- include('partials/head') %>
    <title>Dashboard - Finansave</title>
</head>
<body>
    <%- include('partials/navbar') %>
    
    <!-- Dashboard Container Moderno -->
    <div class="dashboard-container">
        <%- include('partials/messages') %>

        <!-- Seção Principal do Dashboard -->
        <section class="dashboard-main-section">
            <!-- Painel de Resumo Financeiro -->
            <div class="financial-summary-section mb-5">
                <div class="section-header mb-4">
                    <h2 class="section-title gradient-text">Resumo Financeiro</h2>
                    <p class="section-subtitle">Visão geral da sua situação financeira atual</p>
                </div>
                
                <div class="row g-4">
                    <div class="col-xl-4 col-lg-6 col-md-6">
                        <div class="financial-card card-success animate__animated animate__fadeInUp">
                            <div class="financial-card-header">
                                <div class="financial-card-icon">
                                    <i class="fas fa-arrow-up"></i>
                                </div>
                                <div class="financial-card-info">
                                    <h6 class="financial-card-title">Receitas</h6>
                                    <p class="financial-card-subtitle">Total de entradas</p>
                                </div>
                            </div>
                            <div class="financial-card-body">
                                <h2 class="financial-card-value" id="totalReceitas">R$ 0,00</h2>
                                <div class="financial-card-trend positive">
                                    <i class="fas fa-trending-up"></i>
                                    <span>+12.5% este mês</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-xl-4 col-lg-6 col-md-6">
                        <div class="financial-card card-danger animate__animated animate__fadeInUp animate__delay-1s">
                            <div class="financial-card-header">
                                <div class="financial-card-icon">
                                    <i class="fas fa-arrow-down"></i>
                                </div>
                                <div class="financial-card-info">
                                    <h6 class="financial-card-title">Despesas</h6>
                                    <p class="financial-card-subtitle">Total de saídas</p>
                                </div>
                            </div>
                            <div class="financial-card-body">
                                <h2 class="financial-card-value" id="totalDespesas">R$ 0,00</h2>
                                <div class="financial-card-trend negative">
                                    <i class="fas fa-trending-down"></i>
                                    <span>-8.3% este mês</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-xl-4 col-lg-12 col-md-12">
                        <div class="financial-card card-primary animate__animated animate__fadeInUp animate__delay-2s">
                            <div class="financial-card-header">
                                <div class="financial-card-icon">
                                    <i class="fas fa-balance-scale"></i>
                                </div>
                                <div class="financial-card-info">
                                    <h6 class="financial-card-title">Saldo Atual</h6>
                                    <p class="financial-card-subtitle">Balanço geral</p>
                                </div>
                            </div>
                            <div class="financial-card-body">
                                <h2 class="financial-card-value" id="saldoAtual">R$ 0,00</h2>
                                <div class="financial-card-trend positive">
                                    <i class="fas fa-wallet"></i>
                                    <span>Situação estável</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Seção de Análises e Gráficos -->
        <section class="analytics-section">
            <div class="section-header mb-4">
                <h2 class="section-title gradient-text">Análises Financeiras</h2>
                <p class="section-subtitle">Visualize seus dados financeiros de forma inteligente</p>
            </div>
            
            <div class="row g-4 mb-5">
                <div class="col-xl-8 col-lg-7">
                    <div class="analytics-card animate__animated animate__fadeInUp">
                        <div class="analytics-card-header">
                            <div class="analytics-card-title">
                                <i class="fas fa-chart-line text-primary"></i>
                                <h5>Evolução do Saldo</h5>
                            </div>
                            <div class="analytics-card-controls">
                                <div class="btn-group btn-group-sm" role="group">
                                    <input type="radio" class="btn-check" name="periodoSaldo" id="periodo7d" value="7" checked>
                                    <label class="btn btn-outline-primary" for="periodo7d">7D</label>
                                    <input type="radio" class="btn-check" name="periodoSaldo" id="periodo30d" value="30">
                                    <label class="btn btn-outline-primary" for="periodo30d">30D</label>
                                    <input type="radio" class="btn-check" name="periodoSaldo" id="periodo90d" value="90">
                                    <label class="btn btn-outline-primary" for="periodo90d">90D</label>
                                </div>
                            </div>
                        </div>
                        <div class="analytics-card-body">
                            <canvas id="saldoChart" height="100"></canvas>
                        </div>
                    </div>
                </div>
                
                <div class="col-xl-4 col-lg-5">
                    <div class="analytics-card animate__animated animate__fadeInUp animate__delay-1s h-100">
                        <div class="analytics-card-header">
                            <div class="analytics-card-title">
                                <i class="fas fa-chart-pie text-success"></i>
                                <h5>Gastos por Categoria</h5>
                            </div>
                        </div>
                        <div class="analytics-card-body">
                            <canvas id="categoriaChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Seção de Próximas Parcelas -->
        <section class="upcoming-installments-section">
            <div class="section-header mb-4">
                <h2 class="section-title gradient-text" id="upcomingTitle">Próximas Parcelas</h2>
                <p class="section-subtitle">Acompanhe as próximas cobranças dos seus parcelamentos</p>
            </div>

            <div class="analytics-card animate__animated animate__fadeInUp animate__delay-2s">
                <div class="analytics-card-header">
                    <div class="analytics-card-title">
                        <i class="fas fa-calendar-check text-info"></i>
                        <h5>Até 3 próximas parcelas</h5>
                    </div>
                    <div class="analytics-card-controls">
                        <a href="/parcelamentos" class="btn btn-outline-primary btn-sm">
                            <i class="fas fa-list"></i> Ver todos
                        </a>
                    </div>
                </div>
                <div class="analytics-card-body" role="region" aria-labelledby="upcomingTitle" aria-live="polite">
                    <div id="upcomingInstallmentsList" class="list-group list-group-flush" role="list"></div>
                    <div id="upcomingEmptyState" class="text-muted small" style="display: none;">
                        <i class="fas fa-info-circle" aria-hidden="true"></i> Nenhuma parcela prevista nos próximos dias.
                    </div>
                </div>
            </div>
        </section>
    </div>

    <%- include('partials/footer') %>

    <!-- Dashboard Charts Script -->
    <script src="/js/dashboard-charts.js"></script>

    <script>
        // Inicializar tooltips
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[title]'))
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl)
        })

        // Animação para os cards
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.card-hover').forEach(function(card) {
                card.addEventListener('mouseenter', function() {
                    this.classList.add('card-hover-active');
                });
                card.addEventListener('mouseleave', function() {
                    this.classList.remove('card-hover-active');
                });
            });
        });
    </script>
</body>
</html>